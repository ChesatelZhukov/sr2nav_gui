#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Светлая цветовая тема для интерфейса приложения.

Содержит централизованное определение всех цветов, используемых в UI,
для обеспечения единообразного внешнего вида и лёгкой смены темы.

Архитектурные принципы:
    - Все цвета определены как константы в dataclass
    - Класс заморожен (frozen) для неизменяемости
    - Цвета заданы в HEX формате для совместимости с Tkinter
    - Функция apply_theme для рекурсивного применения темы

При добавлении новых цветов:
    - Группируйте их по функциональному назначению
    - Используйте осмысленные имена
    - Комментируйте неочевидные случаи
"""
from dataclasses import dataclass


@dataclass(frozen=True)
class Theme:
    """
    Светлая цветовая тема интерфейса.
    
    Все цвета представлены в формате HEX-строк, которые напрямую
    принимаются Tkinter (например, "#f8f9fa").
    
    Группы цветов:
        - BG_*: фоновые цвета различных уровней
        - FG_*: цвета текста
        - ACCENT_*: акцентные цвета для кнопок и выделения
        - Статусные цвета (SUCCESS, WARNING, ERROR, INFO, DEBUG)
        - Состояния (HOVER, SELECTED, DISABLED)
    """
    
    # ============ ОСНОВНЫЕ ФОНЫ ============
    # Используются для различных уровней вложенности
    BG_PRIMARY: str = "#f8f9fa"      # Основной фон окна
    BG_SECONDARY: str = "#ffffff"     # Фон вложенных элементов (панели, карточки)
    BG_TERTIARY: str = "#e9ecef"      # Фон для выделенных областей
    
    # ============ ЦВЕТА ТЕКСТА ============
    FG_PRIMARY: str = "#212529"       # Основной текст
    FG_SECONDARY: str = "#6c757d"     # Второстепенный текст (подписи, статусы)
    FG_DISABLED: str = "#adb5bd"      # Текст в отключённых элементах
    
    # ============ ГРАНИЦЫ И РАЗДЕЛИТЕЛИ ============
    BORDER: str = "#dee2e6"           # Цвет рамок и разделительных линий
    
    # ============ АКЦЕНТНЫЕ ЦВЕТА ============
    # Используются для кнопок и важных элементов
    ACCENT_BLUE: str = "#0d6efd"       # Основной акцент (действия)
    ACCENT_GREEN: str = "#198754"      # Успешные операции
    ACCENT_RED: str = "#dc3545"        # Опасные действия, ошибки
    ACCENT_ORANGE: str = "#fd7e14"     # Предупреждения, внимание
    ACCENT_PURPLE: str = "#6f42c1"     # Дополнительные действия
    ACCENT_CYAN: str = "#0dcaf0"       # Информационные элементы
    
    # ============ СТАТУСНЫЕ ЦВЕТА ============
    # Для подсветки сообщений в консоли вывода
    SUCCESS: str = "#212529"           # Успешное завершение (тёмный текст)
    WARNING: str = "#E7870A"           # Предупреждения (жёлтый)
    ERROR: str = "#dc3545"             # Ошибки (красный)
    INFO: str = "#212529"              # Информация (тёмный текст)
    DEBUG: str = "#212529"             # Отладочная информация (тёмный текст)
    
    # ============ СОСТОЯНИЯ ЭЛЕМЕНТОВ ============
    HOVER: str = "#e9ecef"             # При наведении мыши
    SELECTED: str = "#cfe2ff"          # Выбранный элемент
    DISABLED: str = "#e9ecef"          # Отключённый элемент


def apply_theme(widget) -> None:
    """
    Рекурсивно применяет тему к виджету и всем его дочерним элементам.
    
    Функция изменяет фон виджетов, которые используют системные цвета
    по умолчанию ('SystemButtonFace', 'SystemWindow', '#f0f0f0'),
    заменяя их на основной цвет темы (BG_PRIMARY).
    
    Args:
        widget: Виджет Tkinter, к которому применяется тема
    
    Note:
        - Функция рекурсивно обходит всех потомков виджета
        - Изменяет только фон, цвета текста нужно устанавливать отдельно
        - Не выбрасывает исключения при ошибках применения темы
        - Подходит для применения после создания всех виджетов
    
    Example:
        >>> root = tk.Tk()
        >>> create_all_widgets(root)
        >>> apply_theme(root)  # Применить тему ко всем виджетам
    """
    # Получаем текущий цвет фона виджета
    bg = widget.cget('bg')
    
    # Если виджет использует системный цвет по умолчанию, меняем его
    if bg in ('SystemButtonFace', 'SystemWindow', '#f0f0f0'):
        try:
            widget.configure(bg=Theme.BG_PRIMARY)
        except:
            # Некоторые виджеты могут не поддерживать изменение bg
            pass
    
    # Рекурсивно обрабатываем дочерние виджеты
    try:
        for child in widget.winfo_children():
            apply_theme(child)
    except:
        # Некоторые виджеты могут не иметь winfo_children
        pass